{
  "Resources": {
    "callRecordingsQueue8A876F51": {
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain",
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/callRecordingsQueue/Resource"
      }
    },
    "callRecordingsQueuePolicyBF42DA71": {
      "Type": "AWS::S3::BucketPolicy",
      "Properties": {
        "Bucket": {
          "Ref": "callRecordingsQueue8A876F51"
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Principal": "*",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    {
                      "Fn::GetAtt": [
                        "callRecordingsQueue8A876F51",
                        "Arn"
                      ]
                    },
                    "/*"
                  ]
                ]
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/callRecordingsQueue/Policy/Resource"
      }
    },
    "callRecordingsProcessed8F6BCACB": {
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain",
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/callRecordingsProcessed/Resource"
      }
    },
    "callRecordingsProcessedPolicyC8547754": {
      "Type": "AWS::S3::BucketPolicy",
      "Properties": {
        "Bucket": {
          "Ref": "callRecordingsProcessed8F6BCACB"
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Principal": "*",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    {
                      "Fn::GetAtt": [
                        "callRecordingsProcessed8F6BCACB",
                        "Arn"
                      ]
                    },
                    "/*"
                  ]
                ]
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/callRecordingsProcessed/Policy/Resource"
      }
    },
    "MediaConversionBatchRoleF9934C59": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "batch.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSBatchServiceRole"
              ]
            ]
          }
        ],
        "RoleName": {
          "Fn::Join": [
            "",
            [
              {
                "Ref": "AWS::StackName"
              },
              "-ServiceRole"
            ]
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/MediaConversionBatchRole/Resource"
      }
    },
    "MediaConversionECSRoleCBCFFF23": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "ecs-tasks.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
              ]
            ]
          }
        ],
        "RoleName": {
          "Fn::Join": [
            "",
            [
              {
                "Ref": "AWS::StackName"
              },
              "-ExecutionRole"
            ]
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/MediaConversionECSRole/Resource"
      }
    },
    "MediaConversionECSRoleDefaultPolicy323DB1C4": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "ecr:BatchCheckLayerAvailability",
                "ecr:GetDownloadUrlForLayer",
                "ecr:BatchGetImage"
              ],
              "Effect": "Allow",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    "arn:aws:ecr:",
                    {
                      "Ref": "AWS::Region"
                    },
                    ":",
                    {
                      "Ref": "AWS::AccountId"
                    },
                    ":repository/test-repo"
                  ]
                ]
              }
            },
            {
              "Action": "ecr:GetAuthorizationToken",
              "Effect": "Allow",
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "MediaConversionECSRoleDefaultPolicy323DB1C4",
        "Roles": [
          {
            "Ref": "MediaConversionECSRoleCBCFFF23"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/MediaConversionECSRole/DefaultPolicy/Resource"
      }
    },
    "SecurityGroupDD263621": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupDescription": "Allow inbound connections from me",
        "GroupName": {
          "Fn::Join": [
            "",
            [
              {
                "Ref": "AWS::StackName"
              },
              "-SecurityGroup"
            ]
          ]
        },
        "SecurityGroupEgress": [
          {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1"
          }
        ],
        "VpcId": "vpc-0b29e85ac121a157f"
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/SecurityGroup/Resource"
      }
    },
    "ComputeEnvironmentEcsInstanceRoleFE696BC2": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "ec2.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/ComputeEnvironment/Ecs-Instance-Role/Resource"
      }
    },
    "ComputeEnvironmentInstanceProfile42D17404": {
      "Type": "AWS::IAM::InstanceProfile",
      "Properties": {
        "Roles": [
          {
            "Ref": "ComputeEnvironmentEcsInstanceRoleFE696BC2"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/ComputeEnvironment/Instance-Profile"
      }
    },
    "ComputeEnvironmentC570994D": {
      "Type": "AWS::Batch::ComputeEnvironment",
      "Properties": {
        "ServiceRole": {
          "Fn::GetAtt": [
            "MediaConversionBatchRoleF9934C59",
            "Arn"
          ]
        },
        "Type": "MANAGED",
        "ComputeEnvironmentName": {
          "Fn::Join": [
            "",
            [
              {
                "Ref": "AWS::StackName"
              },
              "-FargateCE"
            ]
          ]
        },
        "ComputeResources": {
          "AllocationStrategy": "BEST_FIT",
          "InstanceRole": {
            "Fn::GetAtt": [
              "ComputeEnvironmentInstanceProfile42D17404",
              "Arn"
            ]
          },
          "InstanceTypes": [
            "optimal"
          ],
          "MaxvCpus": 2,
          "MinvCpus": 0,
          "SecurityGroupIds": [
            {
              "Fn::GetAtt": [
                "SecurityGroupDD263621",
                "GroupId"
              ]
            }
          ],
          "Subnets": [
            "subnet-051ac495571393b43",
            "subnet-0a654e1cad5949b11"
          ],
          "Type": "EC2"
        },
        "State": "ENABLED"
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/ComputeEnvironment/Resource"
      }
    },
    "JobDefinition24FFE3ED": {
      "Type": "AWS::Batch::JobDefinition",
      "Properties": {
        "Type": "container",
        "ContainerProperties": {
          "Image": {
            "Fn::Join": [
              "",
              [
                {
                  "Ref": "AWS::AccountId"
                },
                ".dkr.ecr.",
                {
                  "Ref": "AWS::Region"
                },
                ".",
                {
                  "Ref": "AWS::URLSuffix"
                },
                "/test-repo:latest"
              ]
            ]
          },
          "InstanceType": "c4.xlarge",
          "JobRoleArn": {
            "Fn::GetAtt": [
              "MediaConversionECSRoleCBCFFF23",
              "Arn"
            ]
          },
          "LogConfiguration": {
            "LogDriver": "awslogs"
          },
          "Memory": 512,
          "Privileged": false,
          "ReadonlyRootFilesystem": false,
          "Vcpus": 0.25
        },
        "JobDefinitionName": {
          "Fn::Join": [
            "",
            [
              {
                "Ref": "AWS::StackName"
              },
              "-JobDefinition"
            ]
          ]
        },
        "RetryStrategy": {
          "Attempts": 1
        },
        "Timeout": {}
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/JobDefinition/Resource"
      }
    },
    "testQueue601B0FCD": {
      "Type": "AWS::Batch::JobQueue",
      "Properties": {
        "ComputeEnvironmentOrder": [
          {
            "ComputeEnvironment": {
              "Ref": "ComputeEnvironmentC570994D"
            },
            "Order": 0
          }
        ],
        "Priority": 1,
        "State": "ENABLED"
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/testQueue/Resource"
      }
    },
    "CDKMetadata": {
      "Type": "AWS::CDK::Metadata",
      "Properties": {
        "Modules": "aws-cdk=1.90.0,@aws-cdk/assets=1.91.0,@aws-cdk/aws-applicationautoscaling=1.91.0,@aws-cdk/aws-autoscaling=1.91.0,@aws-cdk/aws-autoscaling-common=1.91.0,@aws-cdk/aws-autoscaling-hooktargets=1.91.0,@aws-cdk/aws-batch=1.91.0,@aws-cdk/aws-cloudformation=1.91.0,@aws-cdk/aws-cloudwatch=1.91.0,@aws-cdk/aws-codebuild=1.91.0,@aws-cdk/aws-codeguruprofiler=1.91.0,@aws-cdk/aws-codepipeline=1.91.0,@aws-cdk/aws-codepipeline-actions=1.91.0,@aws-cdk/aws-codestarconnections=1.91.0,@aws-cdk/aws-ec2=1.91.0,@aws-cdk/aws-ecr=1.91.0,@aws-cdk/aws-ecr-assets=1.91.0,@aws-cdk/aws-ecs=1.91.0,@aws-cdk/aws-elasticloadbalancingv2=1.91.0,@aws-cdk/aws-events=1.91.0,@aws-cdk/aws-events-targets=1.91.0,@aws-cdk/aws-iam=1.91.0,@aws-cdk/aws-kms=1.91.0,@aws-cdk/aws-lambda=1.91.0,@aws-cdk/aws-logs=1.91.0,@aws-cdk/aws-s3=1.91.0,@aws-cdk/aws-s3-assets=1.91.0,@aws-cdk/aws-servicediscovery=1.91.0,@aws-cdk/aws-sns=1.91.0,@aws-cdk/aws-sns-subscriptions=1.91.0,@aws-cdk/aws-sqs=1.91.0,@aws-cdk/aws-ssm=1.91.0,@aws-cdk/cloud-assembly-schema=1.91.0,@aws-cdk/core=1.91.0,@aws-cdk/custom-resources=1.91.0,@aws-cdk/cx-api=1.91.0,@aws-cdk/region-info=1.91.0,jsii-runtime=node.js/v15.8.0"
      },
      "Metadata": {
        "aws:cdk:path": "MediaConversionWorkerStack/CDKMetadata/Default"
      }
    }
  }
}